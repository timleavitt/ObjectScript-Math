language: minimal
os: linux
services:
  - docker
env:
  - container_image="intersystemsdc/iris-community:2019.4.0.383.0-zpm"
    instance="iris"
install:
  - docker pull $container_image
  - docker run -d -h $instance --name $instance --init $container_image
  - docker ps
  - docker logs $instance
  - until docker exec --interactive $instance iris session $instance < `echo halt`; do sleep 1; done # Wait for instance to be ready
script:
  - docker exec --interactive $instance iris session $instance -B < `echo 'zpm "install objectscript-math" halt'`
  - docker exec --interactive $instance iris session $instance -B < `echo 'zpm "objectscript-math test -only -verbose -DUnitTest.JUnitOutput=junit.xml" halt'`